@echo off
REM =====================================================================
REM АВТОМАТИЧЕСКАЯ ОЧИСТКА БД - Windows версия
REM =====================================================================

echo ========================================================================
echo   АВТОМАТИЧЕСКАЯ ОЧИСТКА БАЗЫ ДАННЫХ (Windows)
echo ========================================================================
echo.

REM Проверка что manage.py существует
if not exist "manage.py" (
    echo [ERROR] manage.py не найден!
    echo Запустите скрипт из корневой директории проекта
    pause
    exit /b 1
)

REM Активация виртуального окружения (если есть)
if exist "venv\Scripts\activate.bat" (
    echo [INFO] Активация виртуального окружения...
    call venv\Scripts\activate.bat
)

echo.
echo ========================================================================
echo ШАГ 1: ПРОВЕРКА БАЗЫ ДАННЫХ
echo ========================================================================
echo.

python scripts\check_database.py

echo.
echo ========================================================================
echo ШАГ 2: ОЧИСТКА (АВТОМАТИЧЕСКИ)
echo ========================================================================
echo.

python scripts\auto_fix_all.py --auto

echo.
echo ========================================================================
echo ГОТОВО!
echo ========================================================================
echo.
echo Следующие шаги:
echo   1. Перезапустите Django сервер (Ctrl+C, затем python manage.py runserver)
echo   2. Проверьте сайт: http://localhost:8000/requisites/
echo.
pause

