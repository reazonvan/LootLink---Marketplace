# üìã –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ï–ö–¢–ê LOOTLINK

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** AI Assistant  
**–¶–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä:** 91.218.245.178 (HOSTKEY VPS)

---

## üéØ –ö–†–ê–¢–ö–ê–Ø –û–¶–ï–ù–ö–ê

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| **–û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** | 8.5/10 | –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ |
| **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production** | 85% | –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ |
| **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞** | 9/10 | –•–æ—Ä–æ—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Å–ª–µ–¥—É–µ—Ç best practices |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | 8/10 | –•–æ—Ä–æ—à–∞—è –∑–∞—â–∏—Ç–∞, –Ω–æ –µ—Å—Ç—å —á—Ç–æ —É–ª—É—á—à–∏—Ç—å |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | 9/10 | –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | 7/10 | –ï—Å—Ç—å —Ç–µ—Å—Ç—ã, –Ω–æ –ø–æ–∫—Ä—ã—Ç–∏–µ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å |

---

## 1Ô∏è‚É£ –ß–¢–û –ú–û–ñ–ù–û –£–õ–£–ß–®–ò–¢–¨

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

#### 1.1 ALLOWED_HOSTS –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç IP —Å–µ—Ä–≤–µ—Ä–∞
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
ALLOWED_HOSTS = ['localhost', '127.0.0.1', 'yourdomain.duckdns.org']
```
**–ù–µ—Ç IP:** `91.218.245.178`

**–†–µ—à–µ–Ω–∏–µ:**
```python
ALLOWED_HOSTS = ['localhost', '127.0.0.1', '91.218.245.178', 'lootlink.ru', 'www.lootlink.ru']
```

#### 1.2 SECRET_KEY –≤–∏–¥–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:**
```
SECRET_KEY = 'x62wn+6rovj-ej2g8b=!9-=&m(gkki4%l8#fm*2rn_1p%*l)#='
```
–≠—Ç–æ—Ç –∫–ª—é—á –ù–ï –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –∫–æ–¥–µ!

**–†–µ—à–µ–Ω–∏–µ:**
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π SECRET_KEY
- –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ `.env` —Ñ–∞–π–ª–µ
- –î–æ–±–∞–≤–∏—Ç—å `.env` –≤ `.gitignore`

#### 1.3 –ü–∞—Ä–æ–ª—å –ë–î –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ env_production.txt
**–ü—Ä–æ–±–ª–µ–º–∞:**
```
DB_PASSWORD=5906639Pe
```
–§–∞–π–ª `env_production.txt` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!

**–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–∏—Ç—å `env_production.txt` –∏–∑ Git
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`
- –°–æ–∑–¥–∞–≤–∞—Ç—å `.env` —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

#### 1.4 –õ–æ–∫–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite –≤–º–µ—Å—Ç–æ PostgreSQL
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å `db.sqlite3` (282 KB)
- Settings –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ PostgreSQL, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è SQLite

**–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–∏—Ç—å `db.sqlite3` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –≤–µ–∑–¥–µ (–∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∏ –Ω–∞ production)

---

### üü° –í–ê–ñ–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

#### 2.1 –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ .bat —Ñ–∞–π–ª–æ–≤ (36 —à—Ç—É–∫!)
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:
```
COMPLETE_FIX.bat
FINAL_FIX.bat
ONE_COMMAND_FIX.bat
fix_and_deploy.bat
fix_csp_and_static.bat
... (–µ—â–µ 31 —Ñ–∞–π–ª)
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Å—Ç–∞–≤–∏—Ç—å –¢–û–õ–¨–ö–û —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ:
   - `quick_start.bat` - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - `deploy.bat` - –¥–ª—è –¥–µ–ø–ª–æ—è
   - `test.bat` - –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

2. –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤:
   - `scripts/deprecated/` - —Å—Ç–∞—Ä—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
   - –ò–ª–∏ —É–¥–∞–ª–∏—Ç—å —Å–æ–≤—Å–µ–º

#### 2.2 DEBUG=True –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
**–ü—Ä–æ–±–ª–µ–º–∞:**
–°–µ–π—á–∞—Å –≤ `.env` –º–æ–∂–µ—Ç –±—ã—Ç—å `DEBUG=False`, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É.

**–†–µ—à–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞:
- `.env.development` (DEBUG=True)
- `.env.production` (DEBUG=False)

–ò –≤ `manage.py` –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

#### 2.3 –ù–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è email (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è console backend)
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
```
–ü–∏—Å—å–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è!

**–†–µ—à–µ–Ω–∏–µ:**
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP:
```env
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=noreply@lootlink.ru
```

#### 2.4 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç –≤ Nginx
**–ü—Ä–æ–±–ª–µ–º–∞:**
–í `nginx_lootlink.conf` —Ç–æ–ª—å–∫–æ HTTP (–ø–æ—Ä—Ç 80), –Ω–µ—Ç HTTPS.

**–†–µ—à–µ–Ω–∏–µ:**
```nginx
server {
    listen 80;
    listen 443 ssl http2;
    server_name 91.218.245.178;
    
    # SSL certificates
    ssl_certificate /etc/letsencrypt/live/lootlink.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/lootlink.ru/privkey.pem;
    
    # Redirect HTTP to HTTPS
    if ($scheme != "https") {
        return 301 https://$host$request_uri;
    }
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}
```

#### 2.5 –ù–µ—Ç backup —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è production
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å—Ç—å —Å–∫—Ä–∏–ø—Ç—ã `backup_db.sh` –∏ `backup_db.bat`, –Ω–æ –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ backup.

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –≤ crontab –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup –≤ 3:00
0 3 * * * /opt/lootlink/scripts/backup_db.sh
```

#### 2.6 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
SENTRY_DSN = config('SENTRY_DSN', default='')
```
Sentry –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –æ—à–∏–±–∫–∏ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è!

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ sentry.io
2. –ü–æ–ª—É—á–∏—Ç—å DSN
3. –î–æ–±–∞–≤–∏—Ç—å –≤ `.env`:
   ```
   SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
   ```

#### 2.7 Redis –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
USE_REDIS=False  # –ª–æ–∫–∞–ª—å–Ω–æ
```
–ù–æ –Ω–∞ production –Ω—É–∂–µ–Ω Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ Celery.

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Redis –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

#### 2.8 Celery –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å—Ç—å systemd —Å–µ—Ä–≤–∏—Å—ã (`lootlink-celery.service`), –Ω–æ –æ–Ω–∏ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
sudo systemctl enable lootlink-celery
sudo systemctl enable lootlink-celery-beat
```

#### 2.9 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç CI/CD pipeline
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ GitHub Actions –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–æ –Ω–µ—Ç `.github/workflows/`.

**–†–µ—à–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å `.github/workflows/django.yml`:
```yaml
name: Django CI
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: postgres
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt
      - run: pytest
```

#### 2.10 –ù–µ—Ç rate limiting –¥–ª—è API endpoints
**–ü—Ä–æ–±–ª–µ–º–∞:**
Rate limiting —Ç–æ–ª—å–∫–æ –¥–ª—è login/register, –Ω–æ –Ω–µ –¥–ª—è API.

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –≤ middleware:
```python
RATE_LIMITS = {
    '/chat/api/messages/': (60, 60),  # 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
    '/notifications/unread-count/': (30, 60),
}
```

---

### üü¢ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò (—Ö–æ—Ä–æ—à–æ –±—ã –¥–æ–±–∞–≤–∏—Ç—å)

#### 3.1 –î–æ–±–∞–≤–∏—Ç—å Docker –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —É –≤—Å–µ—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- PostgreSQL + Redis –∏–∑ –∫–æ—Ä–æ–±–∫–∏

**–ö–∞–∫:**
```bash
docker-compose up -d
```

#### 3.2 –£–≤–µ–ª–∏—á–∏—Ç—å test coverage –¥–æ 80%+
**–°–µ–π—á–∞—Å:** ~65%  
**–¶–µ–ª—å:** 80%+

**–ß—Ç–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**
- Edge cases –≤ –º–æ–¥–µ–ª—è—Ö
- Permissions –≤ views
- –§–æ—Ä–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- Security (CSRF, XSS)

#### 3.3 –î–æ–±–∞–≤–∏—Ç—å pre-commit hooks
**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º.

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.12.0
    hooks:
      - id: black
  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8
```

#### 3.4 –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª—ã (—É–∂–µ –µ—Å—Ç—å, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)
**–°–µ–π—á–∞—Å:**
```python
logs/lootlink.log
logs/errors.log
logs/security.log
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (—É–∂–µ –µ—Å—Ç—å - 5MB, 5 backups) ‚úÖ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –Ω–∞ email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ELK Stack (–¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)

#### 3.5 –î–æ–±–∞–≤–∏—Ç—å WebSockets –¥–ª—è real-time —á–∞—Ç–∞
**–°–µ–π—á–∞—Å:** Polling –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã  
**–õ—É—á—à–µ:** WebSockets (Django Channels)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- Online —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### 3.6 –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–ª–∞—Ç–µ–∂–µ–π
**–û–ø—Ü–∏–∏:**
- –ÆKassa (–¥–ª—è –†–æ—Å—Å–∏–∏)
- Stripe (–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ)
- PayPal

**–§—É–Ω–∫—Ü–∏–∏:**
- Escrow (–¥–µ–Ω—å–≥–∏ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
- –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

#### 3.7 –î–æ–±–∞–≤–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (2FA)
**–î–ª—è:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤.

**–í–∞—Ä–∏–∞–Ω—Ç—ã:**
- SMS –∫–æ–¥
- Google Authenticator
- Email –∫–æ–¥

#### 3.8 –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü
**–°–µ–π—á–∞—Å:** –ö–µ—à–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (5 –º–∏–Ω—É—Ç)

**–ú–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å:**
- –°–ø–∏—Å–æ–∫ –∏–≥—Ä (1 —á–∞—Å)
- –¢–æ–ø –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ (10 –º–∏–Ω—É—Ç)
- –ö–∞—Ç–∞–ª–æ–≥ (—Å invalidation –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö)

#### 3.9 –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ.

**–†–µ—à–µ–Ω–∏–µ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è thumbnails
- WebP —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- Lazy loading

#### 3.10 –î–æ–±–∞–≤–∏—Ç—å sitemap.xml –∏ robots.txt –¥–ª—è SEO
**–°–µ–π—á–∞—Å:** –ï—Å—Ç—å `robots.txt`, –Ω–æ –Ω–µ—Ç `sitemap.xml`

**–ù—É–∂–Ω–æ:**
```python
# urls.py
from django.contrib.sitemaps.views import sitemap
from .sitemaps import ListingSitemap, StaticViewSitemap

sitemaps = {
    'listings': ListingSitemap,
    'static': StaticViewSitemap,
}

urlpatterns = [
    path('sitemap.xml', sitemap, {'sitemaps': sitemaps}),
]
```

---

## 2Ô∏è‚É£ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò

#### 1. ALLOWED_HOSTS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production —Å–µ—Ä–≤–µ—Ä–∞
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ `91.218.245.178` Django –≤–µ—Ä–Ω–µ—Ç 400 Bad Request.

**–ì–¥–µ:** `config/settings.py`, —Å—Ç—Ä–æ–∫–∞ 31

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='localhost,127.0.0.1,91.218.245.178').split(',')
```

–ò –≤ `.env`:
```env
ALLOWED_HOSTS=91.218.245.178,lootlink.ru,www.lootlink.ru
```

#### 2. DEBUG=False –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞—Ç–∏–∫–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ `DEBUG=False` Django –Ω–µ –æ—Ç–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–ì–¥–µ:** `config/settings.py`, `config/urls.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# urls.py
if not settings.USE_S3 and settings.DEBUG:  # ‚ùå –†–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –ø—Ä–∏ DEBUG=True
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –¥–ª—è –æ—Ç–¥–∞—á–∏ —Å—Ç–∞—Ç–∏–∫–∏ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ `nginx_lootlink.conf`) ‚úÖ

#### 3. CSRF trusted origins –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ HTTPS –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å CSRF –∑–∞—â–∏—Ç–∞.

**–ì–¥–µ:** `config/settings.py`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
if not DEBUG:
    CSRF_TRUSTED_ORIGINS = [
        'https://91.218.245.178',
        'https://lootlink.ru',
        'https://www.lootlink.ru',
    ]
```

#### 4. –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ 404 –∏ 500 –≤ production
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å —à–∞–±–ª–æ–Ω—ã `404.html` –∏ `500.html`, –Ω–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω handler.

**–ì–¥–µ:** `config/urls.py`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# urls.py
handler404 = 'core.views.custom_404'
handler500 = 'core.views.custom_500'
```

–ò —Å–æ–∑–¥–∞—Ç—å views:
```python
# core/views.py
def custom_404(request, exception):
    return render(request, '404.html', status=404)

def custom_500(request):
    return render(request, '500.html', status=500)
```

---

### üü° –õ–û–ì–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò

#### 5. Race condition –≤ update_rating()
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–µ—Ç–æ–¥ `Profile.update_rating()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SELECT FOR UPDATE`, —á—Ç–æ —Ö–æ—Ä–æ—à–æ, –Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `Review.save()` –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

**–ì–¥–µ:** `accounts/models.py`, —Å—Ç—Ä–æ–∫–∞ 143-164

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```python
# transactions/models.py
def save(self, *args, **kwargs):
    super().save(*args, **kwargs)
    self.reviewed_user.profile.update_rating()  # ‚ö†Ô∏è –í—ã–∑–æ–≤ –±–µ–∑ transaction.atomic()
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
from django.db import transaction

def save(self, *args, **kwargs):
    with transaction.atomic():
        super().save(*args, **kwargs)
        self.reviewed_user.profile.update_rating()
```

#### 6. N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ —Å–ø–∏—Å–∫–µ –±–µ—Å–µ–¥
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –±–µ—Å–µ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å N+1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–ì–¥–µ:** `chat/models.py`, –º–µ—Ç–æ–¥ `get_last_message()`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –í template
{% for conversation in conversations %}
    {{ conversation.get_last_message.content }}  # ‚ùå N+1 –∑–∞–ø—Ä–æ—Å!
{% endfor %}
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –í view
conversations = Conversation.objects.prefetch_related(
    Prefetch('messages', queryset=Message.objects.order_by('-created_at')[:1])
)
```

#### 7. –ñ–µ—Å—Ç–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ soft delete
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (CASCADE).

**–ì–¥–µ:** `chat/models.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
sender = models.ForeignKey(
    CustomUser,
    on_delete=models.CASCADE,  # ‚ùå –£–¥–∞–ª–∏—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
on_delete=models.SET_NULL  # –û—Å—Ç–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ –æ–±–Ω—É–ª–∏—Ç—å sender
# –∏–ª–∏
on_delete=models.SET(get_deleted_user)  # –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ [deleted]
```

#### 8. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä `MinValueValidator(0)`, –Ω–æ –Ω–µ—Ç CHECK constraint –≤ –ë–î.

**–ì–¥–µ:** `listings/models.py`, –ø–æ–ª–µ `price`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
```python
migrations.AddConstraint(
    model_name='listing',
    constraint=models.CheckConstraint(
        check=models.Q(price__gte=0),
        name='listing_price_positive'
    )
)
```

#### 9. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±–µ–∑ —É—á–µ—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è Django –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –º–µ–¥–ª–µ–Ω–Ω–∞—è.

**–ì–¥–µ:** `listings/views.py`, `catalog()`

**–°–µ–π—á–∞—Å:**
```python
paginator = Paginator(listings, 12)  # ‚ùå COUNT(*) –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—É—Ä—Å–æ—Ä–Ω—É—é –ø–∞–≥–∏–Ω–∞—Ü–∏—é –∏–ª–∏ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å count:
```python
from django.core.cache import cache

cache_key = f'listings_count_{filter_hash}'
count = cache.get(cache_key)
if count is None:
    count = listings.count()
    cache.set(cache_key, count, 300)  # 5 –º–∏–Ω—É—Ç
```

#### 10. –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞ –≤ —á–∞—Ç–µ
**–û–ø–∏—Å–∞–Ω–∏–µ:** Rate limiting –µ—Å—Ç—å (50 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É), –Ω–æ –Ω–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

**–ì–¥–µ:** `chat/views.py`

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:
```python
last_message = Message.objects.filter(
    conversation=conversation,
    sender=request.user
).order_by('-created_at').first()

if last_message and last_message.content == new_content:
    if (timezone.now() - last_message.created_at).seconds < 10:
        messages.error(request, '–ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥!')
        return redirect(...)
```

---

### üü¢ –ú–ï–õ–ö–ò–ï –ë–ê–ì–ò

#### 11. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —à–∞–±–ª–æ–Ω–∞—Ö
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Ä–µ–º—è –≤ –±–∞–∑–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ UTC, –Ω–æ –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
–í settings —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
```python
TIME_ZONE = 'Europe/Moscow'
USE_TZ = True  # ‚úÖ
```

–ù–æ –≤ —à–∞–±–ª–æ–Ω–∞—Ö –Ω—É–∂–Ω–æ:
```django
{{ message.created_at|date:"d.m.Y H:i" }}  # ‚ùå UTC –≤—Ä–µ–º—è
{{ message.created_at|timezone:"Europe/Moscow"|date:"d.m.Y H:i" }}  # ‚úÖ –ú–æ—Å–∫–æ–≤—Å–∫–æ–µ
```

#### 12. JavaScript escapeHtml –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–ª—É—á–∞–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è `escapeHtml()` –≤ `chat-improvements.js` –Ω–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –≤—Å–µ—Ö XSS.

**–ì–¥–µ:** `static/js/chat-improvements.js`

**–°–µ–π—á–∞—Å:**
```javascript
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;  // ‚úÖ –•–æ—Ä–æ—à–æ –¥–ª—è –±–∞–∑–æ–≤–æ–π –∑–∞—â–∏—Ç—ã
}
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç event handlers:
```javascript
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;',
        '/': '&#x2F;'
    };
    return text.replace(/[&<>"'\/]/g, m => map[m]);
}
```

#### 13. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ AJAX –∑–∞–ø—Ä–æ—Å–∞—Ö
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –æ—à–∏–±–∫–µ AJAX –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.

**–ì–¥–µ:** `static/js/*.js`

**–ü—Ä–∏–º–µ—Ä:**
```javascript
fetch('/api/endpoint/')
    .then(response => response.json())
    .then(data => {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    });
    // ‚ùå –ù–µ—Ç .catch()!
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```javascript
fetch('/api/endpoint/')
    .then(response => {
        if (!response.ok) throw new Error('Network error');
        return response.json();
    })
    .then(data => {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞
    })
    .catch(error => {
        console.error('Error:', error);
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
    });
```

---

## 3Ô∏è‚É£ –ß–ï–ì–û –ù–ï –•–í–ê–¢–ê–ï–¢

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û–ï

#### 1. .env —Ñ–∞–π–ª –¥–ª—è production
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ `.env` —Ñ–∞–π–ª–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ `91.218.245.178`.

**–†–µ—à–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```env
# Django Settings
SECRET_KEY=–°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨_–ù–û–í–´–ô_–ö–õ–Æ–ß_–ó–î–ï–°–¨
DEBUG=False
ALLOWED_HOSTS=91.218.245.178,lootlink.ru,www.lootlink.ru

# Database Settings
DB_NAME=lootlink_db
DB_USER=lootlink_user
DB_PASSWORD=–ë–ï–ó–û–ü–ê–°–ù–´–ô_–ü–ê–†–û–õ–¨
DB_HOST=localhost
DB_PORT=5432

# Email Settings
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=–≤–∞—à-email@gmail.com
EMAIL_HOST_PASSWORD=–ø–∞—Ä–æ–ª—å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
DEFAULT_FROM_EMAIL=noreply@lootlink.ru

# Redis Settings
USE_REDIS=True
REDIS_URL=redis://localhost:6379/1

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Security
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True

# Monitoring
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
ENVIRONMENT=production
RELEASE_VERSION=1.0.0
```

#### 2. SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTPS.

**–†–µ—à–µ–Ω–∏–µ:**
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–º–µ–Ω–∞:
```bash
sudo certbot --nginx -d lootlink.ru -d www.lootlink.ru
```

–ò–ª–∏ –¥–ª—è IP (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π):
```bash
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/nginx-selfsigned.key \
  -out /etc/ssl/certs/nginx-selfsigned.crt
```

#### 3. Firewall –ø—Ä–∞–≤–∏–ª–∞
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `deploy_to_vps.sh` –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW, –Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω—ã –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞.

**–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å SSH —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ IP
sudo ufw allow from YOUR_IP to any port 22

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ PostgreSQL –∏–∑–≤–Ω–µ
sudo ufw deny 5432

# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å Redis
sudo ufw deny 6379
```

#### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

**–ù—É–∂–Ω–æ:**
- **Django Debug Toolbar** (—Ç–æ–ª—å–∫–æ –¥–ª—è development)
- **django-silk** –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **Prometheus + Grafana** –¥–ª—è –º–µ—Ç—Ä–∏–∫
- **Sentry** –¥–ª—è –æ—à–∏–±–æ–∫ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ –∫–æ–¥–µ, –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ DSN)

---

### üü° –í–ê–ñ–ù–´–ï –§–£–ù–ö–¶–ò–ò

#### 5. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ email
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–¥ –≥–æ—Ç–æ–≤, –Ω–æ email backend = console (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∏—Å—å–º–∞).

**–ù—É–∂–Ω–æ:**
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP (—Å–º. –≤—ã—à–µ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å").

#### 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å —Å–∫—Ä–∏–ø—Ç—ã, –Ω–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω cron.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo crontab -e

# –î–æ–±–∞–≤–∏—Ç—å:
0 3 * * * /opt/lootlink/scripts/backup_db.sh
0 4 * * 0 /opt/lootlink/scripts/backup_media.sh  # –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
```

#### 7. Rate limiting –ø–æ IP
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–π—á–∞—Å rate limiting –ø–æ –ø—É—Ç–∏, –Ω–æ –Ω–µ –ø–æ IP –≥–ª–æ–±–∞–ª—å–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –≤ Nginx:
```nginx
limit_req_zone $binary_remote_addr zone=general:10m rate=100r/m;

server {
    location / {
        limit_req zone=general burst=20 nodelay;
        proxy_pass http://lootlink_app;
    }
}
```

#### 8. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å `security.log`, –Ω–æ –Ω–µ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.

**–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –æ–¥–Ω–æ–≥–æ IP
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ –∞–¥–º–∏–Ω–∫–µ

```python
import logging
security_logger = logging.getLogger('django.security')

# –í view
if failed_login_attempts > 5:
    security_logger.warning(
        f'Multiple failed login attempts from IP {ip} for user {username}'
    )
```

#### 9. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ email
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å –º–æ–¥–µ–ª—å `PasswordResetCode`, –Ω–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞.

**–°—Ç–∞—Ç—É—Å:** –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SMTP.

#### 10. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï—Å—Ç—å –º–æ–¥–µ–ª—å `EmailVerification`, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

**–ù—É–∂–Ω–æ:**
–í `accounts/views.py` –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
```python
# –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω
verification = EmailVerification.create_for_user(user)

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å email
send_verification_email(user, verification.token)

# –ù–µ –¥–∞–≤–∞—Ç—å –≤—Ö–æ–¥–∏—Ç—å –ø–æ–∫–∞ email –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
user.is_active = False
user.save()
```

---

### üü¢ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò

#### 11. –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–µ–π—á–∞—Å –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –æ–ø–∏—Å–∞–Ω–∏—é.

**–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
class Listing(models.Model):
    # ...
    tags = models.ManyToManyField('Tag', blank=True)

class Tag(models.Model):
    name = models.CharField(max_length=50, unique=True)
    slug = models.SlugField(unique=True)
```

#### 12. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–≥—Ä—ã/—Ü–µ–Ω—ã.

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```python
def get_similar_listings(listing):
    return Listing.objects.filter(
        game=listing.game,
        status='active'
    ).exclude(
        id=listing.id
    ).order_by('?')[:4]  # 4 —Å–ª—É—á–∞–π–Ω—ã—Ö
```

#### 13. –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω—ã
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–∞–∫ –º–µ–Ω—è–ª–∞—Å—å —Ü–µ–Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.

**–ú–æ–¥–µ–ª—å:**
```python
class PriceHistory(models.Model):
    listing = models.ForeignKey(Listing, on_delete=models.CASCADE)
    old_price = models.DecimalField(max_digits=10, decimal_places=2)
    new_price = models.DecimalField(max_digits=10, decimal_places=2)
    changed_at = models.DateTimeField(auto_now_add=True)
```

#### 14. Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Web Push)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–∞–π—Ç –∑–∞–∫—Ä—ã—Ç.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** Service Workers + Web Push API

#### 15. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GDPR)
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å –≤—Å–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ.

**View:**
```python
@login_required
def export_data(request):
    data = {
        'profile': serialize_profile(request.user.profile),
        'listings': serialize_listings(request.user.listings.all()),
        'messages': serialize_messages(request.user),
    }
    return JsonResponse(data, safe=False)
```

---

## 4Ô∏è‚É£ –ß–¢–û –õ–ò–®–ù–ï–ï

### üî¥ –£–î–ê–õ–ò–¢–¨ –ù–ï–ú–ï–î–õ–ï–ù–ù–û (—Ñ–∞–π–ª—ã —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

#### 1. env_production.txt
**–ü—Ä–∏—á–∏–Ω–∞:** –°–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!
```
DB_PASSWORD=5906639Pe  # ‚ùå –ü–ê–†–û–õ–¨ –í –†–ï–ü–û–ó–ò–¢–û–†–ò–ò!
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm env_production.txt
git commit -m "Remove sensitive data"
echo "env_production.txt" >> .gitignore
```

#### 2. db.sqlite3
**–ü—Ä–∏—á–∏–Ω–∞:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm db.sqlite3
echo "db.sqlite3" >> .gitignore
```

#### 3. lootlink_backup.dump
**–ü—Ä–∏—á–∏–Ω–∞:** Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (110 KB) –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm lootlink_backup.dump
echo "*.dump" >> .gitignore
```

#### 4. exports/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
**–ü—Ä–∏—á–∏–Ω–∞:** –≠–∫—Å–ø–æ—Ä—Ç—ã –¥–∞–Ω–Ω—ã—Ö (lootlink_data_*.json, lootlink_media_backup.zip).

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm -r exports/
echo "exports/" >> .gitignore
```

#### 5. logs/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
**–ü—Ä–∏—á–∏–Ω–∞:** –õ–æ–≥–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm -r logs/
echo "logs/" >> .gitignore
# –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p logs
touch logs/.gitkeep
```

---

### üü° –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –£–î–ê–õ–ò–¢–¨ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ/–¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ñ–∞–π–ª—ã)

#### 6. –õ–∏—à–Ω–∏–µ .bat —Ñ–∞–π–ª—ã (26 —à—Ç—É–∫!)
**–°–ø–∏—Å–æ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
```
COMPLETE_FIX.bat
FINAL_FIX.bat
FINAL_COMPLETE_SETUP.bat
FINAL_CSP_FIX.bat
ONE_COMMAND_FIX.bat
check_and_fix_everything.bat
disable_ssl_redirect.bat
fix_csp_and_static.bat
fix_allowed_hosts.bat
fix_permissions_and_start.bat
diagnose_and_fix.bat
fix_socket_and_launch.bat
fix_nginx_config.bat
fix_gunicorn_service.bat
fix_database.bat
complete_setup.bat
fix_and_deploy.bat
final_deploy.bat
check_status.bat
final_fix_all.bat
DEPLOY_NOW.bat
deploy_quick_start.bat
LAUNCH_SITE_NOW.bat
launch_with_notifications.bat
FULL_DIAGNOSTIC.bat
import_data_final.bat
```

**–û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ:**
- `quick_start.bat` - –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
- `test.bat` - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π)
- `deploy.bat` - –¥–µ–ø–ª–æ–π (–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª—É—á—à–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ –æ–¥–∏–Ω)

#### 7. docs/archive/ (70 —Ñ–∞–π–ª–æ–≤!)
**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:**
–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –≤–µ—Ç–∫—É `archive` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å:
```bash
git rm -r docs/archive/
# –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤–Ω—É—é –≤–µ—Ç–∫—É
git checkout -b archive
git mv docs/archive/ .
git commit -m "Archive old docs"
git checkout main
git rm -r docs/archive/
```

#### 8. –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è MD —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ
**–§–∞–π–ª—ã:**
- `README_DEPLOY.md` (–µ—Å—Ç—å `docs/DEPLOYMENT.md`)
- `FIXES_SUMMARY.md` (—É—Å—Ç–∞—Ä–µ–ª–æ)
- `CHANGELOG.md` (–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
- `START_HERE.txt` (–µ—Å—Ç—å `README.md`)
- `CONTRIBUTING.md` (–µ—Å–ª–∏ –Ω–µ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞)

**–†–µ—à–µ–Ω–∏–µ:**
- –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–∏–Ω `README.md` + `docs/`
- –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã

#### 9. –ü—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤
**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
find . -name "tests.py" -size 0
```

–ï—Å–ª–∏ –µ—Å—Ç—å –ø—É—Å—Ç—ã–µ - —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å placeholder:
```python
# tests.py
def test_placeholder():
    """–¢–µ—Å—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ."""
    pass
```

#### 10. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ scripts/
**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- `add_games.py` - –µ—Å–ª–∏ –∏–≥—Ä—ã —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- `create_test_data.py` - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `setup_dev.py` - –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ `scripts/dev/` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

### üü¢ –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã)

#### 11. staticfiles/admin/
**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ç–∏–∫–∞ –∞–¥–º–∏–Ω–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
git rm -r staticfiles/
echo "staticfiles/" >> .gitignore
```

#### 12. media/ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è S3)
**–ü—Ä–∏—á–∏–Ω–∞:** –ï—Å–ª–∏ –º–µ–¥–∏–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ S3, –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
# –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ USE_S3=True –≤ production
git rm -r media/
echo "media/" >> .gitignore
mkdir -p media
touch media/.gitkeep
```

#### 13. __pycache__/ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
**–ü—Ä–∏—á–∏–Ω–∞:** Python –∫–µ—à–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
find . -name "__pycache__" -type d
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
find . -name "__pycache__" -type d -exec rm -rf {} +
echo "__pycache__/" >> .gitignore
echo "*.pyc" >> .gitignore
```

#### 14. .vscode/ –∏–ª–∏ .idea/
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ IDE –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã.

**–î–µ–π—Å—Ç–≤–∏–µ:**
```bash
echo ".vscode/" >> .gitignore
echo ".idea/" >> .gitignore
echo "*.swp" >> .gitignore
```

#### 15. docker-entrypoint.sh (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Docker)
**–ü—Ä–∏—á–∏–Ω–∞:** –ï—Å–ª–∏ –¥–µ–ø–ª–æ–π –±–µ–∑ Docker, —Ñ–∞–π–ª –Ω–µ –Ω—É–∂–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
–û—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ —Å–ª—É—á–∞–π –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Docker.

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –ó–ê–î–ê–ß

### üö® –î–ï–õ–ê–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–° (–ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º)

| ‚Ññ | –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---|--------|-------|-------------|
| 1 | –î–æ–±–∞–≤–∏—Ç—å 91.218.245.178 –≤ ALLOWED_HOSTS | 5 –º–∏–Ω | üî¥ CRITICAL |
| 2 | –£–¥–∞–ª–∏—Ç—å env_production.txt –∏–∑ Git | 5 –º–∏–Ω | üî¥ CRITICAL |
| 3 | –£–¥–∞–ª–∏—Ç—å db.sqlite3 –∏–∑ Git | 2 –º–∏–Ω | üî¥ CRITICAL |
| 4 | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π SECRET_KEY | 2 –º–∏–Ω | üî¥ CRITICAL |
| 5 | –°–æ–∑–¥–∞—Ç—å .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | 10 –º–∏–Ω | üî¥ CRITICAL |
| 6 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CSRF_TRUSTED_ORIGINS | 5 –º–∏–Ω | üî¥ CRITICAL |
| 7 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | 5 –º–∏–Ω | üî¥ CRITICAL |
| 8 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ | 5 –º–∏–Ω | üî¥ CRITICAL |

**–ò—Ç–æ–≥–æ:** ~40 –º–∏–Ω—É—Ç

### ‚ö†Ô∏è –î–ï–õ–ê–¢–¨ –í –ü–ï–†–í–£–Æ –ù–ï–î–ï–õ–Æ

| ‚Ññ | –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –í–∞–∂–Ω–æ—Å—Ç—å |
|---|--------|-------|----------|
| 9 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å email (SMTP) | 15 –º–∏–Ω | üü° HIGH |
| 10 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL (Certbot –∏–ª–∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π) | 20 –º–∏–Ω | üü° HIGH |
| 11 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (cron) | 10 –º–∏–Ω | üü° HIGH |
| 12 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | 15 –º–∏–Ω | üü° HIGH |
| 13 | –ó–∞–ø—É—Å—Ç–∏—Ç—å Celery –Ω–∞ production | 10 –º–∏–Ω | üü° HIGH |
| 14 | –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ .bat —Ñ–∞–π–ª—ã | 30 –º–∏–Ω | üü° MEDIUM |
| 15 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞ | 15 –º–∏–Ω | üü° HIGH |
| 16 | –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ 404/500 | 15 –º–∏–Ω | üü° MEDIUM |

**–ò—Ç–æ–≥–æ:** ~2.5 —á–∞—Å–∞

### üìÖ –î–ï–õ–ê–¢–¨ –í –ü–ï–†–í–´–ô –ú–ï–°–Ø–¶

| ‚Ññ | –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|--------|-------|-----------|
| 17 | –£–≤–µ–ª–∏—á–∏—Ç—å test coverage –¥–æ 80% | 2 –¥–Ω—è | üü¢ MEDIUM |
| 18 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD pipeline | 4 —á–∞—Å–∞ | üü¢ MEDIUM |
| 19 | –î–æ–±–∞–≤–∏—Ç—å WebSockets –¥–ª—è —á–∞—Ç–∞ | 1 –¥–µ–Ω—å | üü¢ LOW |
| 20 | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 3 —á–∞—Å–∞ | üü¢ MEDIUM |
| 21 | –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–ª–∞—Ç–µ–∂–µ–π | 3 –¥–Ω—è | üü¢ LOW |
| 22 | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus + Grafana | 1 –¥–µ–Ω—å | üü¢ LOW |

---

## üîç –°–ü–ï–¶–ò–§–ò–ö–ê –î–õ–Ø –°–ï–†–í–ï–†–ê 91.218.245.178

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ:

```
IP: 91.218.245.178
OS: Ubuntu 24.04
CPU: 4 vCore
RAM: 6 GB
Disk: 120 GB SSD
Location: RU
Provider: HOSTKEY
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

#### 1. –û–±–Ω–æ–≤–∏—Ç—å ALLOWED_HOSTS
```python
# config/settings.py
ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='localhost,127.0.0.1,91.218.245.178').split(',')
```

#### 2. –û–±–Ω–æ–≤–∏—Ç—å Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```nginx
# /etc/nginx/sites-available/lootlink
server {
    listen 80;
    server_name 91.218.245.178;
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
}
```

#### 3. –û–±–Ω–æ–≤–∏—Ç—å deploy —Å–∫—Ä–∏–ø—Ç
```bash
# scripts/deploy_to_vps.sh
# –°—Ç—Ä–æ–∫–∞ 99:
ALLOWED_HOSTS=91.218.245.178,localhost
```

#### 4. –°–æ–∑–¥–∞—Ç—å .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```env
ALLOWED_HOSTS=91.218.245.178
```

#### 5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ–º–µ–Ω)
–ï—Å–ª–∏ –∫—É–ø–∏—Ç–µ –¥–æ–º–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, lootlink.ru):
```
A record: lootlink.ru -> 91.218.245.178
A record: www.lootlink.ru -> 91.218.245.178
```

#### 6. Firewall
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo ufw allow from any to any port 80
sudo ufw allow from any to any port 443
sudo ufw allow from YOUR_HOME_IP to any port 22  # SSH —Ç–æ–ª—å–∫–æ —Å –≤–∞—à–µ–≥–æ IP
sudo ufw enable
```

#### 7. –û–±–Ω–æ–≤–∏—Ç—å systemd —Å–µ—Ä–≤–∏—Å—ã
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ `/etc/systemd/system/lootlink.service`:
```ini
Environment="ALLOWED_HOSTS=91.218.245.178"
```

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –ó–ê–ü–£–°–ö–û–ú –ù–ê PRODUCTION

### Pre-Deployment Checklist

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] `SECRET_KEY` —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∑–∞–Ω–æ–≤–æ –∏ –Ω–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- [ ] `DEBUG=False` –≤ production
- [ ] `ALLOWED_HOSTS` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] `CSRF_TRUSTED_ORIGINS` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è HTTPS
- [ ] –í—Å–µ –ø–∞—Ä–æ–ª–∏ –≤ `.env`, –Ω–µ –≤ –∫–æ–¥–µ
- [ ] `.env` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`
- [ ] `db.sqlite3` —É–¥–∞–ª–µ–Ω –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [ ] `env_production.txt` —É–¥–∞–ª–µ–Ω –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [ ] –ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (`chmod 600 .env`)
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω (UFW)
- [ ] Fail2ban —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] SSH –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î —Å–æ–∑–¥–∞–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ `pg_trgm` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (–¥–ª—è full-text search)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (`python manage.py migrate`)
- [ ] –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω
- [ ] –ò–≥—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥
- [ ] –ë—ç–∫–∞–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω (cron)

#### –°—Ç–∞—Ç–∏–∫–∞ –∏ –º–µ–¥–∏–∞
- [ ] `python manage.py collectstatic` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ—Ç–¥–∞—á–∏ `/static/`
- [ ] Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ—Ç–¥–∞—á–∏ `/media/`
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ `staticfiles/` –∏ `media/` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] AWS S3 –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

#### –°–µ—Ä–≤–∏—Å—ã
- [ ] Gunicorn –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Nginx –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω
- [ ] Redis –∑–∞–ø—É—â–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- [ ] Celery worker –∑–∞–ø—É—â–µ–Ω
- [ ] Celery beat –∑–∞–ø—É—â–µ–Ω
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ (`systemctl enable`)

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏
- [ ] Sentry –Ω–∞—Å—Ç—Ä–æ–µ–Ω (DSN –¥–æ–±–∞–≤–ª–µ–Ω)
- [ ] –õ–æ–≥–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `/var/log/lootlink/`
- [ ] –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] Prometheus+Grafana –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (`pytest`)
- [ ] Coverage > 65%
- [ ] –°–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ IP
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ß–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞

#### Performance
- [ ] Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] PostgreSQL –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] Full-text search —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°—Ç–∞—Ç–∏–∫–∞ —Å–∂–∏–º–∞–µ—Ç—Å—è (gzip)
- [ ] –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

#### SSL/HTTPS (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] HSTS –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω
- [ ] Mixed content –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

---

## üéØ –ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å ALLOWED_HOSTS** - –¥–æ–±–∞–≤–∏—Ç—å `91.218.245.178`
2. ‚úÖ **–£–¥–∞–ª–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ Git (–ø–∞—Ä–æ–ª–∏, –±–∞–∑—ã)
3. ‚úÖ **–°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π .env** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å email** (SMTP) –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
5. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL** —Ö–æ—Ç—è –±—ã —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π
6. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø—ã** (cron)
7. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (Sentry)
8. ‚úÖ **–ü–æ—á–∏—Å—Ç–∏—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã** (.bat, —Å—Ç–∞—Ä—ã–µ docs)

### –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ production:

| –≠—Ç–∞–ø | –í—Ä–µ–º—è |
|------|-------|
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | 1 —á–∞—Å |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ | 2-3 —á–∞—Å–∞ |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 1 —á–∞—Å |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 1 —á–∞—Å |
| **–ò–¢–û–ì–û** | **5-6 —á–∞—Å–æ–≤** |

### –û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

```
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë  85%

–ì–æ—Ç–æ–≤–æ –∫ production —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏!
```

### –†–∏—Å–∫–∏:

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –û—à–∏–±–∫–∞ 400 –∏–∑-–∑–∞ ALLOWED_HOSTS | –í–´–°–û–ö–ê–Ø | –ö–†–ò–¢–ò–ß–ù–û | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º |
| –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è SECRET_KEY | –°–†–ï–î–ù–Ø–Ø | –í–´–°–û–ö–û–ï | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π |
| –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö (–Ω–µ—Ç –±—ç–∫–∞–ø–æ–≤) | –ù–ò–ó–ö–ê–Ø | –ö–†–ò–¢–ò–ß–ù–û | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–±—ç–∫–∞–ø |
| –ù–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–π email | –í–´–°–û–ö–ê–Ø | –°–†–ï–î–ù–ï–ï | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SMTP |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –í–´–°–û–ö–ê–Ø | –°–†–ï–î–ù–ï–ï | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry |

---

## üìû –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ (30 –º–∏–Ω—É—Ç)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π .gitignore
cat >> .gitignore << EOF
.env
env_production.txt
db.sqlite3
*.dump
exports/
logs/*.log
media/
staticfiles/
__pycache__/
*.pyc
.vscode/
.idea/
EOF

# 2. –£–¥–∞–ª–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
git rm env_production.txt
git rm db.sqlite3
git rm lootlink_backup.dump
git rm -r exports/
git rm -r logs/
git rm -r staticfiles/

# 3. –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω .env
cp env.example.txt .env.template

# 4. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git add .
git commit -m "Security: Remove sensitive files, fix .gitignore"
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (2 —á–∞—Å–∞)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@91.218.245.178
# –ü–∞—Ä–æ–ª—å: BWJ_1anRP0

# 2. –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
passwd

# 3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
cd /opt
git clone https://github.com/–≤–∞—à-username/LootLink.git lootlink

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π —Å–∫—Ä–∏–ø—Ç
cd lootlink
chmod +x scripts/deploy_to_vps.sh
sudo bash scripts/deploy_to_vps.sh

# 5. –°–æ–∑–¥–∞—Ç—å .env
sudo nano /opt/lootlink/.env
# (–≤—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ –≤—ã—à–µ)

# 6. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd /opt/lootlink
source venv/bin/activate
python manage.py migrate
python manage.py createsuperuser
python manage.py collectstatic --noinput

# 7. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
sudo systemctl start lootlink
sudo systemctl start nginx

# 8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://91.218.245.178
```

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (30 –º–∏–Ω—É—Ç)

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/lootlink
source venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
pytest

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo journalctl -u lootlink -f
sudo tail -f /var/log/nginx/lootlink-error.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status lootlink nginx postgresql redis
```

### –®–∞–≥ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (1 —á–∞—Å)

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry
# (–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ sentry.io –∏ –ø–æ–ª—É—á–∏—Ç—å DSN)

# 2. –î–æ–±–∞–≤–∏—Ç—å –≤ .env
echo "SENTRY_DSN=https://your-dsn@sentry.io/project" >> /opt/lootlink/.env

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart lootlink

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø—ã
sudo crontab -e
# –î–æ–±–∞–≤–∏—Ç—å:
# 0 3 * * * /opt/lootlink/scripts/backup_db.sh
```

---

## üéì –í–´–í–û–î–´

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∞:

‚úÖ –û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (MVC, separation of concerns)  
‚úÖ –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README, ARCHITECTURE, API_DOCUMENTATION)  
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ (CSRF, XSS, Rate Limiting, CSP)  
‚úÖ PostgreSQL —Å Full-Text Search  
‚úÖ Celery –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á  
‚úÖ Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã (65% coverage)  
‚úÖ Docker –ø–æ–¥–¥–µ—Ä–∂–∫–∞  
‚úÖ –ì–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è  

### –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:

‚ùå –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–ø–∞—Ä–æ–ª–∏, SECRET_KEY)  
‚ùå ALLOWED_HOSTS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è production —Å–µ—Ä–≤–µ—Ä–∞  
‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö .bat —Ñ–∞–π–ª–æ–≤  
‚ùå Email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (console backend)  
‚ùå –ù–µ—Ç SSL  
‚ùå –ù–µ—Ç CI/CD  
‚ùå Monitoring –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–Ω–µ—Ç Sentry DSN)  

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:

**9/10** - –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç! üéâ

–¢—Ä–µ–±—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–±–æ–ª—å—à–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ production.

---

**–ê–≤—Ç–æ—Ä –∞–Ω–∞–ª–∏–∑–∞:** AI Assistant  
**–î–∞—Ç–∞:** 27 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0


