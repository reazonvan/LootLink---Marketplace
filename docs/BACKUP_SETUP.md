# üíæ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ë–µ–∫–∞–ø–æ–≤

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `scripts/auto_backup.sh` —Å–æ–∑–¥–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–µ–∫–∞–ø—ã:
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (—Å–∂–∞—Ç—ã–π SQL dump)
- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã (–∞–≤–∞—Ç–∞—Ä—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±–µ–∫–∞–ø–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/lootlink

# –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/auto_backup.sh

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –±–µ–∫–∞–ø–æ–≤
sudo mkdir -p /var/backups/lootlink
sudo chown $USER:$USER /var/backups/lootlink
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
./scripts/auto_backup.sh
```

–í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å:
```
[2025-10-28 12:00:00] –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –±–µ–∫–∞–ø–æ–≤...
[2025-10-28 12:00:01] –ù–∞—á–∞–ª–æ –±–µ–∫–∞–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
[2025-10-28 12:00:05] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: /var/backups/lootlink/db_20251028_120001.sql.gz
[2025-10-28 12:00:05] –†–∞–∑–º–µ—Ä –±–µ–∫–∞–ø–∞ –ë–î: 1.2M
[2025-10-28 12:00:05] –ù–∞—á–∞–ª–æ –±–µ–∫–∞–ø–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤...
[2025-10-28 12:00:08] –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: /var/backups/lootlink/media_20251028_120005.tar.gz
[2025-10-28 12:00:08] –†–∞–∑–º–µ—Ä –±–µ–∫–∞–ø–∞ –º–µ–¥–∏–∞: 5.3M
[2025-10-28 12:00:08] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–µ–∫–∞–ø–æ–≤:
[2025-10-28 12:00:08]   - –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 2
[2025-10-28 12:00:08]   - –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: 6.5M
[2025-10-28 12:00:08]   - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: /var/backups/lootlink
[2025-10-28 12:00:08] –ë–µ–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (Cron)

```bash
# –û—Ç–∫—Ä—ã—Ç—å crontab –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2 –Ω–æ—á–∏):
0 2 * * * /opt/lootlink/scripts/auto_backup.sh >> /var/log/lootlink-backup.log 2>&1
```

**–î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:**

```bash
# –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3 –Ω–æ—á–∏
0 3 * * * /opt/lootlink/scripts/auto_backup.sh

# –ö–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤ (–≤ 2 –Ω–æ—á–∏ –∏ 2 –¥–Ω—è)
0 2,14 * * * /opt/lootlink/scripts/auto_backup.sh

# –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 1 –Ω–æ—á–∏
0 1 * * 1 /opt/lootlink/scripts/auto_backup.sh

# –î–≤–∞–∂–¥—ã –≤ –¥–µ–Ω—å (2 –Ω–æ—á–∏ –∏ 14:00)
0 2 * * * /opt/lootlink/scripts/auto_backup.sh
0 14 * * * /opt/lootlink/scripts/auto_backup.sh
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–û—Ç–∫—Ä–æ–π—Ç–µ `scripts/auto_backup.sh` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–µ–∫–∞–ø–æ–≤
BACKUP_DIR="/var/backups/lootlink"

# –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DB_NAME="lootlink_db"

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL
DB_USER="lootlink_user"

# –ü—É—Ç—å –∫ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞–º
MEDIA_DIR="/opt/lootlink/media"

# –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ö—Ä–∞–Ω–∏—Ç—å –±–µ–∫–∞–ø—ã
RETENTION_DAYS=30  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 –¥–Ω–µ–π
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∫–∞–ø–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–µ–∫–∞–ø–∞

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–µ–∫–∞–ø–æ–≤
ls -lh /var/backups/lootlink/

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –±–µ–∫–∞–ø–æ–≤
ls -lt /var/backups/lootlink/ | head -5

# –†–∞–∑–º–µ—Ä –≤—Å–µ—Ö –±–µ–∫–∞–ø–æ–≤
du -sh /var/backups/lootlink/
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–µ–∫–∞–ø–æ–≤
tail -f /var/log/lootlink-backup.log

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
tail -50 /var/log/lootlink-backup.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è cron
crontab -l

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π cron
sudo systemctl status cron
```

---

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–µ–∫–∞–ø–∞

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π –±–µ–∫–∞–ø
ls -lt /var/backups/lootlink/db_*.sql.gz

# 2. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –±–µ–∫–∞–ø
gunzip -c /var/backups/lootlink/db_20251028_120001.sql.gz > restore.sql

# 3. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
sudo systemctl stop lootlink

# 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sudo -u postgres psql lootlink_db < restore.sql

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
sudo systemctl start lootlink

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo systemctl status lootlink
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

```bash
# 1. –ù–∞–π—Ç–∏ –±–µ–∫–∞–ø –º–µ–¥–∏–∞
ls -lt /var/backups/lootlink/media_*.tar.gz

# 2. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–∏—Ö –º–µ–¥–∏–∞ (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)
mv /opt/lootlink/media /opt/lootlink/media_old

# 3. –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –±–µ–∫–∞–ø
cd /opt/lootlink
tar -xzf /var/backups/lootlink/media_20251028_120005.tar.gz

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
sudo chown -R www-data:www-data /opt/lootlink/media/

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
sudo systemctl restart lootlink
```

---

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: permission denied

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
ls -ld /var/backups/lootlink

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
sudo chown -R $USER:$USER /var/backups/lootlink
sudo chmod 755 /var/backups/lootlink
```

### –û—à–∏–±–∫–∞: pg_dump command not found

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL client
sudo apt update
sudo apt install postgresql-client
```

### –û—à–∏–±–∫–∞: database does not exist

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
sudo -u postgres psql -l

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è –±–∞–∑—ã –≤ —Å–∫—Ä–∏–ø—Ç–µ
grep "DB_NAME=" scripts/auto_backup.sh
```

### –ë–µ–∫–∞–ø—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ cron —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo systemctl status cron

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ cron
sudo tail -f /var/log/syslog | grep CRON

# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç—É –ø–æ–ª–Ω—ã–π
crontab -l
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: /opt/lootlink/scripts/auto_backup.sh
# –ù–ï: scripts/auto_backup.sh
```

---

## üì¶ –•—Ä–∞–Ω–µ–Ω–∏–µ –±–µ–∫–∞–ø–æ–≤ –≤ –æ–±–ª–∞–∫–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: S3 (AWS/DigitalOcean Spaces/etc)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å AWS CLI
sudo apt install awscli

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å credentials
aws configure

# –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞ auto_backup.sh:
aws s3 sync /var/backups/lootlink/ s3://your-bucket/lootlink-backups/
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: rsync –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –∫–ª—é—á–∏
ssh-keygen
ssh-copy-id user@backup-server.com

# –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞:
rsync -avz /var/backups/lootlink/ user@backup-server.com:/backups/lootlink/
```

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –•—Ä–∞–Ω–µ–Ω–∏–µ –±–µ–∫–∞–ø–æ–≤

1. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –±–µ–∫–∞–ø—ã:** –•—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7-30 –¥–Ω–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. **–£–¥–∞–ª–µ–Ω–Ω—ã–µ –±–µ–∫–∞–ø—ã:** –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ –æ–±–ª–∞–∫–æ
3. **–ê—Ä—Ö–∏–≤–Ω—ã–µ –±–µ–∫–∞–ø—ã:** –°–æ—Ö—Ä–∞–Ω—è—Ç—å –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –±–µ–∫–∞–ø—ã –æ—Ç–¥–µ–ª—å–Ω–æ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–∞–∑ –≤ –º–µ—Å—è—Ü –ø—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ –±–µ–∫–∞–ø—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
# 1. –°–∫–∞—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–µ–∫–∞–ø
# 2. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```bash
# –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –±–µ–∫–∞–ø–æ–≤
sudo chmod 700 /var/backups/lootlink

# –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –±–µ–∫–∞–ø—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
gpg --encrypt --recipient your-email@example.com db_backup.sql.gz
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π (`chmod +x`)
- [ ] –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –±–µ–∫–∞–ø–æ–≤ —Å–æ–∑–¥–∞–Ω–∞
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ —É—Å–ø–µ—à–µ–Ω
- [ ] Cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è
- [ ] –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- [ ] –£–¥–∞–ª–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–ê–≤—Ç–æ—Ä:** LootLink Team  
**–î–∞—Ç–∞:** 28 –û–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0

